import "tfplan/v2" as tfplan

# Restrict AWS deployments to a curated set of regions.
allowed_aws_regions = ["eu-west-1", "eu-central-1", "us-west-2"]

aws_region = (tfplan.variables contains "aws_region") ? tfplan.variables["aws_region"].value : ""

main = rule {
    aws_region == "" or aws_region in allowed_aws_regions
}
